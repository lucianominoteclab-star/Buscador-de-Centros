<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador de Centros</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f4f4;
            padding: 20px;
        }
        .container {
            max-width: 650px;
            margin: auto;
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        input, button {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
        }
        button {
            background: #0c3b2e;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #105c47;
        }
        #resultado {
            margin-top: 20px;
            opacity: 0;
            transition: opacity .3s ease;
        }
        #resultado.show {
            opacity: 1;
        }
        #mapa {
            width: 100%;
            height: 300px;
            margin-top: 15px;
            border-radius: 12px;
        }
    </style>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>

<body>

<div class="container">
    <h2>Buscador de Centros Teclab</h2>

    <input id="localidad" placeholder="Ingres치 tu localidad (ej: Virrey del Pino)">
    <button onclick="buscar()">Buscar centro 游늸</button>

    <div id="resultado"></div>
    <div id="mapa"></div>
</div>

<script>

    /* Coordenadas REALES de localidades espec칤ficas */
    const localidades = {
        "virrey del pino": { lat: -34.8137, lon: -58.6814 },
        "la matanza": { lat: -34.7714, lon: -58.6241 },
        "gonz치lez cat치n": { lat: -34.7875, lon: -58.6253 },
        "isidro casanova": { lat: -34.6995, lon: -58.5861 },
        "ca침uelas": { lat: -35.0526, lon: -58.7401 },
        "merlo": { lat: -34.6654, lon: -58.7276 }
    };

    /* TUS CENTROS REALES */
    const centros = [
        { nombre: "San Miguel", lat: -34.54313, lon: -58.71267, direccion: "Av. Leon Gallardo 207" },
        { nombre: "Don Torcuato", lat: -34.47175, lon: -58.63324, direccion: "Av Angel T de Alvear 2555" },
        { nombre: "Hurlingham", lat: -34.58626, lon: -58.63928, direccion: "Arturo Jauretche 1435" },
        { nombre: "Ca침uelas", lat: -35.0526, lon: -58.7541, direccion: "Av. Libertad 1200" },
        { nombre: "San Mart칤n", lat: -34.56873, lon: -58.5416, direccion: "Sarmiento 1887" },
        { nombre: "Parque Leloir", lat: -34.6331, lon: -58.6876, direccion: "Av Martin Fierro 3246" },
        { nombre: "Munro", lat: -34.5305, lon: -58.5219, direccion: "Av Velez Sarsfield 4898" },
        { nombre: "Merlo", lat: -34.6693, lon: -58.7291, direccion: "Avellaneda 598" },
        { nombre: "Banfield", lat: -34.74188, lon: -58.39118, direccion: "Vieytes 211" }
    ];

    // Haversine
    function haversine(lat1, lon1, lat2, lon2) {
        const R = 6371;
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLon = (lon2 - lon1) * Math.PI / 180;

        const a = Math.sin(dLat/2)**2 +
                  Math.cos(lat1 * Math.PI/180) *
                  Math.cos(lat2 * Math.PI/180) *
                  Math.sin(dLon/2)**2;

        return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    }

    // Mapa
    const mapa = L.map("mapa").setView([-34.70, -58.60], 9);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(mapa);

    let marcadorUsuario = null;
    let marcadores = [];

    function buscar() {
        const userInput = document.getElementById("localidad").value.trim().toLowerCase();

        if (!localidades[userInput]) {
            alert("Localidad no encontrada. Ingres치 una zona v치lida.");
            return;
        }

        const user = localidades[userInput];

        // Distancias a TUS centros
        const distancias = centros.map(c => ({
            ...c,
            dist: haversine(user.lat, user.lon, c.lat, c.lon)
        }));

        // Ordenar del m치s cercano al m치s lejano
        distancias.sort((a, b) => a.dist - b.dist);

        const primero = distancias[0];
        const segundo = distancias[1];

        // Mostrar info
        const box = document.getElementById("resultado");
        box.innerHTML = `
            <h3>Centro m치s cercano:</h3>
            <p><b>${primero.nombre}</b><br>
            Direcci칩n: ${primero.direccion}<br>
            Distancia: ${primero.dist.toFixed(2)} km</p>

            <h3>Segundo centro m치s cercano:</h3>
            <p><b>${segundo.nombre}</b><br>
            Direcci칩n: ${segundo.direccion}<br>
            Distancia: ${segundo.dist.toFixed(2)} km</p>
        `;
        box.classList.add("show");

        // Limpiar marcadores
        if (marcadorUsuario) marcadorUsuario.remove();
        marcadores.forEach(m => m.remove());
        marcadores = [];

        marcadorUsuario = L.marker([user.lat, user.lon]).addTo(mapa).bindPopup("游늸 Tu ubicaci칩n");
        mapa.setView([user.lat, user.lon], 10);

        [primero, segundo].forEach(c => {
            const mk = L.marker([c.lat, c.lon])
                .addTo(mapa)
                .bindPopup(`<b>${c.nombre}</b><br>${c.direccion}<br>${c.dist.toFixed(1)} km`);
            marcadores.push(mk);
        });
    }
</script>

</body>
</html>
